<div class="view-header">
  <h2>Security</h2>
  <p class="view-subtitle">Antivirus protection and security settings</p>
</div>

<div class="security-container">
  <!-- ClamAV Status Card -->
  <div class="card">
    <div class="card-header">
      <div class="card-icon security-icon">
        <svg
          width="24"
          height="24"
          viewBox="0 0 24 24"
          fill="none"
          stroke="currentColor"
          stroke-width="2"
        >
          <path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z" />
        </svg>
      </div>
      <div class="security-header-info">
        <h3>ClamAV Antivirus</h3>
        <div class="security-status">
          <span id="clamav-status-badge" class="badge badge-info">Checking...</span>
          <span id="clamav-status-text" class="security-status-text">Loading...</span>
        </div>
      </div>
    </div>

    <!-- Install Section -->
    <div id="clamav-install-section" class="banner banner-info">
      <div class="banner-icon">
        <svg
          width="20"
          height="20"
          viewBox="0 0 24 24"
          fill="none"
          stroke="currentColor"
          stroke-width="2"
        >
          <circle cx="12" cy="12" r="10" />
          <line x1="12" y1="16" x2="12" y2="12" />
          <line x1="12" y1="8" x2="12.01" y2="8" />
        </svg>
      </div>
      <div class="banner-content">
        <h4>ClamAV Not Installed</h4>
        <p>
          ClamAV is an open-source antivirus engine for detecting trojans, viruses, malware and
          other malicious threats.
        </p>
      </div>
      <div class="btn-group">
        <button id="btn-install-clamav" class="btn-primary">Install ClamAV</button>
        <button id="btn-refresh-status" class="btn-secondary">
          <svg
            width="16"
            height="16"
            viewBox="0 0 24 24"
            fill="none"
            stroke="currentColor"
            stroke-width="2"
          >
            <path
              d="M21.5 2v6h-6M2.5 22v-6h6M2 11.5a10 10 0 0 1 18.8-4.3M22 12.5a10 10 0 0 1-18.8 4.2"
            />
          </svg>
          Refresh
        </button>
      </div>

      <!-- Install Logs Section -->
      <div id="install-logs-section" class="install-logs-section" style="display: none">
        <div class="install-logs-header">
          <div class="install-logs-title">
            <svg
              width="16"
              height="16"
              viewBox="0 0 24 24"
              fill="none"
              stroke="currentColor"
              stroke-width="2"
            >
              <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z" />
              <polyline points="14 2 14 8 20 8" />
              <line x1="16" y1="13" x2="8" y2="13" />
              <line x1="16" y1="17" x2="8" y2="17" />
              <polyline points="10 9 9 9 8 9" />
            </svg>
            <span id="install-logs-title-text">Installation Logs</span>
            <span
              id="install-logs-spinner"
              class="install-logs-spinner"
              style="display: none"
            ></span>
          </div>
          <button id="btn-toggle-install-logs" class="install-logs-toggle">
            <svg
              width="16"
              height="16"
              viewBox="0 0 24 24"
              fill="none"
              stroke="currentColor"
              stroke-width="2"
            >
              <polyline points="6 9 12 15 18 9" />
            </svg>
          </button>
        </div>
        <div id="install-logs-content" class="install-logs-content">
          <div id="install-logs-output" class="install-logs-output"></div>
        </div>
      </div>
    </div>

    <!-- Database Info -->
    <div id="security-controls-section" style="display: none">
      <div class="info-list">
        <div class="info-item">
          <span class="info-label">Database Version</span>
          <span id="db-version" class="info-value">--</span>
        </div>
        <div class="info-item">
          <span class="info-label">Last Update</span>
          <span id="db-last-update" class="info-value">--</span>
        </div>
        <div class="info-item">
          <span class="info-label">Virus Definitions</span>
          <span id="db-definitions" class="info-value">--</span>
        </div>
      </div>

      <div class="btn-group" style="margin-top: 16px">
        <button id="btn-update-definitions" class="btn-secondary">
          <svg
            width="16"
            height="16"
            viewBox="0 0 24 24"
            fill="none"
            stroke="currentColor"
            stroke-width="2"
          >
            <path
              d="M21.5 2v6h-6M2.5 22v-6h6M2 11.5a10 10 0 0 1 18.8-4.3M22 12.5a10 10 0 0 1-18.8 4.2"
            />
          </svg>
          Update Definitions
        </button>
      </div>
    </div>
  </div>

  <!-- Scan Controls -->
  <div class="card">
    <div class="card-header">
      <h3>Scan Options</h3>
    </div>

    <div class="scan-options">
      <div class="scan-option">
        <div class="scan-option-info">
          <h4>Quick Scan</h4>
          <p>Scan common directories (Downloads, Documents, Desktop)</p>
        </div>
        <button id="btn-quick-scan" class="btn-primary">Quick Scan</button>
      </div>

      <div class="scan-option">
        <div class="scan-option-info">
          <h4>Custom Scan</h4>
          <p>Scan a specific file or directory</p>
        </div>
        <div class="scan-path-input-group">
          <input
            type="text"
            id="scan-path-input"
            class="scan-path-input"
            placeholder="/path/to/scan"
          />
          <button id="btn-browse-path" class="btn-secondary btn-small">Browse</button>
          <button id="btn-custom-scan" class="btn-primary">Scan Path</button>
        </div>
      </div>
    </div>

    <!-- Scan Logs Section -->
    <div id="scan-logs-section" class="scan-logs-section" style="display: none">
      <div class="scan-logs-header">
        <div class="scan-logs-title">
          <svg
            width="16"
            height="16"
            viewBox="0 0 24 24"
            fill="none"
            stroke="currentColor"
            stroke-width="2"
          >
            <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z" />
            <polyline points="14 2 14 8 20 8" />
            <line x1="16" y1="13" x2="8" y2="13" />
            <line x1="16" y1="17" x2="8" y2="17" />
            <polyline points="10 9 9 9 8 9" />
          </svg>
          <span id="scan-logs-title-text">Scan Logs</span>
          <span id="scan-logs-spinner" class="scan-logs-spinner" style="display: none"></span>
        </div>
        <button id="btn-toggle-scan-logs" class="scan-logs-toggle">
          <svg
            width="16"
            height="16"
            viewBox="0 0 24 24"
            fill="none"
            stroke="currentColor"
            stroke-width="2"
          >
            <polyline points="6 9 12 15 18 9" />
          </svg>
        </button>
      </div>
      <div id="scan-logs-content" class="scan-logs-content">
        <div id="scan-logs-output" class="scan-logs-output"></div>
      </div>
    </div>
  </div>

  <!-- Scan Results -->
  <div id="scan-results" class="card" style="display: none">
    <div class="card-header">
      <h3>Scan Results</h3>
      <span id="scan-threat-status" class="badge badge-success">Clean</span>
    </div>

    <div id="scan-results-content">
      <div class="scan-summary">
        <div class="scan-summary-item">
          <span class="summary-label">Files Scanned</span>
          <span id="scan-files-count" class="summary-value">0</span>
        </div>
        <div class="scan-summary-item">
          <span class="summary-label">Threats Found</span>
          <span id="scan-threats-count" class="summary-value">0</span>
        </div>
        <div class="scan-summary-item">
          <span class="summary-label">Scan Time</span>
          <span id="scan-time" class="summary-value">0s</span>
        </div>
      </div>

      <div id="threats-list" class="threats-list"></div>
    </div>
  </div>
</div>
